import pandas as pd
import numpy as np

# ============================================================
# –ì–ï–ù–ï–†–ê–¶–Ü–Ø –†–ï–ê–õ–Ü–°–¢–ò–ß–ù–ò–• –î–ê–ù–ò–• –ö–û–†–ò–°–¢–£–í–ê–ß–Ü–í
# ============================================================

print("="*70)
print("–ì–ï–ù–ï–†–ê–¶–Ü–Ø –î–ê–ù–ò–• –î–õ–Ø –ü–û–í–ï–î–Ü–ù–ö–û–í–û–ì–û –ê–ù–ê–õ–Ü–ó–£")
print("="*70)

# –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ seed –¥–ª—è –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞–Ω–æ—Å—Ç—ñ
np.random.seed(42)

# –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (30 - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è —Ä–µ–≥—Ä–µ—Å—ñ—ó)
n_users = 30

# --- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –Ω–µ–∑–∞–ª–µ–∂–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó ---
# –ß–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ: –≤—ñ–¥ 5 –¥–æ 60 —Ö–≤–∏–ª–∏–Ω
time_on_site = np.random.uniform(5, 60, n_users)

# --- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–∞–ª–µ–∂–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó –∑ —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω–∏–º –∑–≤'—è–∑–∫–æ–º ---
# –§–æ—Ä–º—É–ª–∞: –ü–æ–∫—É–ø–∫–∏ = 0.5 + 0.15 √ó –ß–∞—Å + –≤–∏–ø–∞–¥–∫–æ–≤–∏–π_—à—É–º
# –¶–µ —Å—Ç–≤–æ—Ä—é—î –ø–æ–º—ñ—Ç–Ω–∏–π –ø–æ–∑–∏—Ç–∏–≤–Ω–∏–π –∑–≤'—è–∑–æ–∫
noise = np.random.normal(0, 0.8, n_users)
purchases = 0.5 + 0.15 * time_on_site + noise

# –û–∫—Ä—É–≥–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—ñ–¥'—î–º–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω—å
purchases = np.maximum(0, np.round(purchases))

# --- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–∞—Ç–∞—Å–µ—Ç—É –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏ ---
data = {
    'ID_–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞': range(1, n_users + 1),
    '–ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ_—Ö–≤': np.round(time_on_site, 1),
    '–ö—ñ–ª—å–∫—ñ—Å—Ç—å_–ø–æ–∫—É–ø–æ–∫': purchases.astype(int),
    '–ö—ñ–ª—å–∫—ñ—Å—Ç—å_–∫–ª—ñ–∫—ñ–≤': np.random.randint(10, 150, n_users),
    '–ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–æ_—Å—Ç–æ—Ä—ñ–Ω–æ–∫': np.random.randint(3, 50, n_users),
    '–î–æ–¥–∞–Ω–æ_–≤_–∫–æ—à–∏–∫': np.random.randint(0, 8, n_users)
}

df = pd.DataFrame(data)

# --- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —É CSV ---
csv_filename = 'user_behavior_data.csv'
df.to_csv(csv_filename, index=False, encoding='utf-8-sig')

print(f"\n‚úÖ –§–∞–π–ª —É—Å–ø—ñ—à–Ω–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ: {csv_filename}")
print(f"üìä –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: {n_users}")
print(f"üìÅ –†–æ–∑–º—ñ—Ä –¥–∞—Ç–∞—Å–µ—Ç—É: {df.shape[0]} —Ä—è–¥–∫—ñ–≤ √ó {df.shape[1]} —Å—Ç–æ–≤–ø—Ü—ñ–≤")

print("\n--- –ü–µ—Ä—à—ñ 10 –∑–∞–ø–∏—Å—ñ–≤ ---")
print(df.head(10))

print("\n--- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Å–Ω–æ–≤–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö ---")
print(df[['–ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ_—Ö–≤', '–ö—ñ–ª—å–∫—ñ—Å—Ç—å_–ø–æ–∫—É–ø–æ–∫']].describe())

print("\n" + "="*70)
print("‚úÖ –ì–ï–ù–ï–†–ê–¶–Ü–Ø –ó–ê–í–ï–†–®–ï–ù–ê")
print(f"–§–∞–π–ª '{csv_filename}' –≥–æ—Ç–æ–≤–∏–π –¥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!")
print("="*70)   