import pandas as pd
import numpy as np
import statsmodels.api as sm

# ============================================================
# –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –î–ê–ù–ò–• –ó CSV
# ============================================================

print("="*70)
print("–õ–Ü–ù–Ü–ô–ù–ò–ô –†–ï–ì–†–ï–°–Ü–ô–ù–ò–ô –ê–ù–ê–õ–Ü–ó –ü–û–í–ï–î–Ü–ù–ö–ò –ö–û–†–ò–°–¢–£–í–ê–ß–Ü–í")
print("="*70)

# –ß–∏—Ç–∞–Ω–Ω—è CSV —Ñ–∞–π–ª—É
csv_filename = 'user_behavior_data.csv'
df = pd.read_csv(csv_filename)

print(f"\n‚úÖ –î–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ —Ñ–∞–π–ª—É: {csv_filename}")
print(f"üìä –†–æ–∑–º—ñ—Ä –¥–∞—Ç–∞—Å–µ—Ç—É: {df.shape[0]} —Ä—è–¥–∫—ñ–≤ √ó {df.shape[1]} —Å—Ç–æ–≤–ø—Ü—ñ–≤")

print("\n--- –ü–µ—Ä—à—ñ 5 –∑–∞–ø–∏—Å—ñ–≤ ---")
print(df.head())

print("\n--- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–º—ñ–Ω–Ω–∏—Ö ---")
print(df[['–ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ_—Ö–≤', '–ö—ñ–ª—å–∫—ñ—Å—Ç—å_–ø–æ–∫—É–ø–æ–∫']].describe())

# ============================================================
# –ü–û–ë–£–î–û–í–ê –†–ï–ì–†–ï–°–Ü–ô–ù–û–á –ú–û–î–ï–õ–Ü
# ============================================================

print("\n" + "="*70)
print("–í–ò–ö–û–ù–ê–ù–ù–Ø –ó–ê–í–î–ê–ù–ù–Ø")
print("="*70)

# –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö
X = df['–ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ_—Ö–≤']
Y = df['–ö—ñ–ª—å–∫—ñ—Å—Ç—å_–ø–æ–∫—É–ø–æ–∫']

# –î–æ–¥–∞–≤–∞–Ω–Ω—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏ (–≤—ñ–ª—å–Ω–æ–≥–æ —á–ª–µ–Ω–∞) –¥–ª—è OLS
X_const = sm.add_constant(X)

# –ü–æ–±—É–¥–æ–≤–∞ –º–æ–¥–µ–ª—ñ –º–µ—Ç–æ–¥–æ–º –Ω–∞–π–º–µ–Ω—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç—ñ–≤ (OLS)
model = sm.OLS(Y, X_const).fit()

# ============================================================
# –ó–ê–í–î–ê–ù–ù–Ø 1: –§–£–ù–ö–¶–Ü–Ø –†–ï–ì–†–ï–°–Ü–á
# ============================================================

print("\n" + "-"*70)
print("–ó–ê–í–î–ê–ù–ù–Ø 1: –ü–æ–±—É–¥–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—ó —Ä–µ–≥—Ä–µ—Å—ñ—ó")
print("-"*70)

# –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤
b0 = model.params['const']
b1 = model.params['–ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ_—Ö–≤']

print(f"\n–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ —Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä–µ–≥—Ä–µ—Å—ñ—ó:")
print(f"\n  Y = {b0:.3f} + {b1:.3f} √ó X")
print(f"\n–∞–±–æ")
print(f"\n  –ö—ñ–ª—å–∫—ñ—Å—Ç—å_–ø–æ–∫—É–ø–æ–∫ = {b0:.3f} + {b1:.3f} √ó –ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ")

print(f"\n--- –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤ ---")
print(f"\nb0 (–≤—ñ–ª—å–Ω–∏–π —á–ª–µ–Ω) = {b0:.3f}")
print(f"  –ó–Ω–∞—á–µ–Ω–Ω—è: –û—á—ñ–∫—É–≤–∞–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–∫—É–ø–æ–∫ –ø—Ä–∏ —á–∞—Å—ñ –Ω–∞ —Å–∞–π—Ç—ñ = 0 —Ö–≤")
print(f"  –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è: –ë–∞–∑–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –ø–æ–∫—É–ø–æ–∫ –Ω–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —á–∞—Å—É")

print(f"\nb1 (–∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç —Ä–µ–≥—Ä–µ—Å—ñ—ó) = {b1:.3f}")
print(f"  –ó–Ω–∞—á–µ–Ω–Ω—è: –ó–º—ñ–Ω–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø–æ–∫—É–ø–æ–∫ –ø—Ä–∏ –∑–±—ñ–ª—å—à–µ–Ω–Ω—ñ —á–∞—Å—É –Ω–∞ 1 —Ö–≤")
print(f"  –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è: –ü—Ä–∏ –∑–±—ñ–ª—å—à–µ–Ω–Ω—ñ —á–∞—Å—É –Ω–∞ —Å–∞–π—Ç—ñ –Ω–∞ 1 —Ö–≤–∏–ª–∏–Ω—É,")
print(f"                 –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–∫—É–ø–æ–∫ {'–∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è' if b1 > 0 else '–∑–º–µ–Ω—à—É—î—Ç—å—Å—è'}")
print(f"                 –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É –Ω–∞ {abs(b1):.3f} –æ–¥–∏–Ω–∏—Ü—å")

print(f"\n--- –í–ø–ª–∏–≤ –∑–º—ñ–Ω–Ω–æ—ó –Ω–∞ –∑–∞–ª–µ–∂–Ω—É –≤–µ–ª–∏—á–∏–Ω—É ---")
if b1 > 0:
    print(f"–ß–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ –º–∞—î –ü–û–ó–ò–¢–ò–í–ù–ò–ô –≤–ø–ª–∏–≤ –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–∫—É–ø–æ–∫")
    print(f"–ß–∏–º –±—ñ–ª—å—à–µ —á–∞—Å—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—Ä–æ–≤–æ–¥–∏—Ç—å –Ω–∞ —Å–∞–π—Ç—ñ,")
    print(f"—Ç–∏–º –±—ñ–ª—å—à–µ –ø–æ–∫—É–ø–æ–∫ –≤—ñ–Ω –∑–¥—ñ–π—Å–Ω—é—î")
else:
    print(f"–ß–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ –º–∞—î –ù–ï–ì–ê–¢–ò–í–ù–ò–ô –≤–ø–ª–∏–≤ –Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–∫—É–ø–æ–∫")

# ============================================================
# –ó–ê–í–î–ê–ù–ù–Ø 2: –û–¶–Ü–ù–ö–ê –ú–û–î–ï–õ–Ü
# ============================================================

print("\n" + "-"*70)
print("–ó–ê–í–î–ê–ù–ù–Ø 2: –û—Ü—ñ–Ω–∫–∞ —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–æ—ó –º–æ–¥–µ–ª—ñ")
print("-"*70)

# –ö–ª—é—á–æ–≤—ñ –º–µ—Ç—Ä–∏–∫–∏ —è–∫–æ—Å—Ç—ñ –º–æ–¥–µ–ª—ñ
r_squared = model.rsquared
adj_r_squared = model.rsquared_adj
f_statistic = model.fvalue
f_pvalue = model.f_pvalue
p_value_b1 = model.pvalues['–ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ_—Ö–≤']

print(f"\n1. –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –¥–µ—Ç–µ—Ä–º—ñ–Ω–∞—Ü—ñ—ó (R¬≤): {r_squared:.4f}")
print(f"   –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è: –ú–æ–¥–µ–ª—å –ø–æ—è—Å–Ω—é—î {r_squared*100:.1f}% –≤–∞—Ä—ñ–∞—Ü—ñ—ó –ø–æ–∫—É–ø–æ–∫")
if r_squared > 0.7:
    print(f"   –û—Ü—ñ–Ω–∫–∞: –í–ò–°–û–ö–ê –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ")
elif r_squared > 0.5:
    print(f"   –û—Ü—ñ–Ω–∫–∞: –°–ï–†–ï–î–ù–Ø –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ")
else:
    print(f"   –û—Ü—ñ–Ω–∫–∞: –ù–ò–ó–¨–ö–ê –ø–æ—è—Å–Ω—é–≤–∞–ª—å–Ω–∞ –∑–¥–∞—Ç–Ω—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ")

print(f"\n2. –°–∫–æ—Ä–∏–≥–æ–≤–∞–Ω–∏–π R¬≤: {adj_r_squared:.4f}")
print(f"   –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è: –í—Ä–∞—Ö–æ–≤—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –Ω–µ–∑–∞–ª–µ–∂–Ω–∏—Ö –∑–º—ñ–Ω–Ω–∏—Ö")

print(f"\n3. F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {f_statistic:.3f}")
print(f"   P-value –¥–ª—è F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: {f_pvalue:.4f}")
if f_pvalue < 0.05:
    print(f"   –í–∏—Å–Ω–æ–≤–æ–∫: –ú–æ–¥–µ–ª—å –≤ —Ü—ñ–ª–æ–º—É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –ó–ù–ê–ß–£–©–ê (p < 0.05)")
else:
    print(f"   –í–∏—Å–Ω–æ–≤–æ–∫: –ú–æ–¥–µ–ª—å –≤ —Ü—ñ–ª–æ–º—É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –ù–ï –ó–ù–ê–ß–£–©–ê (p ‚â• 0.05)")

print(f"\n4. P-value –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ b1: {p_value_b1:.4f}")
if p_value_b1 < 0.05:
    print(f"   –í–∏—Å–Ω–æ–≤–æ–∫: –í–ø–ª–∏–≤ —á–∞—Å—É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –ó–ù–ê–ß–£–©–ò–ô (p < 0.05)")
    print(f"             –ó–º—ñ–Ω–Ω–∞ '–ß–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ' —î –≤–∞–∂–ª–∏–≤–∏–º –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–º")
else:
    print(f"   –í–∏—Å–Ω–æ–≤–æ–∫: –í–ø–ª–∏–≤ —á–∞—Å—É —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –ù–ï –ó–ù–ê–ß–£–©–ò–ô (p ‚â• 0.05)")
    print(f"             –ó–º—ñ–Ω–Ω–∞ –º–æ–∂–µ –Ω–µ –º–∞—Ç–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–ø–ª–∏–≤—É")

print(f"\n5. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –ø–æ—Ö–∏–±–∫–∞ –º–æ–¥–µ–ª—ñ: {np.sqrt(model.mse_resid):.3f}")
print(f"   –Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è: –°–µ—Ä–µ–¥–Ω—î –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —Ñ–∞–∫—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö –≤—ñ–¥ –ø—Ä–æ–≥–Ω–æ–∑—É")

# –ê–Ω–∞–ª—ñ–∑ –∑–∞–ª–∏—à–∫—ñ–≤ (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—ñ)
residuals = model.resid
print(f"\n6. –ê–Ω–∞–ª—ñ–∑ –∑–∞–ª–∏—à–∫—ñ–≤ (–ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—ñ):")
print(f"   –°–µ—Ä–µ–¥–Ω—î –∑–∞–ª–∏—à–∫—ñ–≤: {residuals.mean():.4f}")
if abs(residuals.mean()) < 0.01:
    print(f"   –û—Ü—ñ–Ω–∫–∞: –í—ñ–¥–º—ñ–Ω–Ω–æ (–±–ª–∏–∑—å–∫–æ –¥–æ 0)")
else:
    print(f"   –û—Ü—ñ–Ω–∫–∞: –ü–æ—Ç—Ä–µ–±—É—î —É–≤–∞–≥–∏ (–º–∞—î –±—É—Ç–∏ ‚âà 0)")
    
print(f"   –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è –∑–∞–ª–∏—à–∫—ñ–≤: {residuals.std():.3f}")

# ============================================================
# –ó–ê–ì–ê–õ–¨–ù–ò–ô –í–ò–°–ù–û–í–û–ö
# ============================================================

print("\n" + "="*70)
print("–ó–ê–ì–ê–õ–¨–ù–ò–ô –í–ò–°–ù–û–í–û–ö")
print("="*70)

print(f"\n‚úÖ –ü–æ–±—É–¥–æ–≤–∞–Ω–æ –ª—ñ–Ω—ñ–π–Ω—É —Ä–µ–≥—Ä–µ—Å—ñ–π–Ω—É –º–æ–¥–µ–ª—å:")
print(f"   –ü–æ–∫—É–ø–∫–∏ = {b0:.3f} + {b1:.3f} √ó –ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ")

print(f"\nüìä –Ø–∫—ñ—Å—Ç—å –º–æ–¥–µ–ª—ñ:")
print(f"   ‚Ä¢ R¬≤ = {r_squared:.4f} ({r_squared*100:.1f}% –ø–æ—è—Å–Ω–µ–Ω–Ω—è –≤–∞—Ä—ñ–∞—Ü—ñ—ó)")
print(f"   ‚Ä¢ –ú–æ–¥–µ–ª—å {'—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â–∞' if f_pvalue < 0.05 else '—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –Ω–µ –∑–Ω–∞—á—É—â–∞'} (F-test: p = {f_pvalue:.4f})")

print(f"\nüìà –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –≤–∏—Å–Ω–æ–≤–∫–∏:")
if p_value_b1 < 0.05 and b1 > 0:
    print(f"   ‚Ä¢ –ß–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ —î –í–ê–ñ–õ–ò–í–ò–ú —Ñ–∞–∫—Ç–æ—Ä–æ–º –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –ø–æ–∫—É–ø–æ–∫")
    print(f"   ‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ü–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä")
    print(f"   ‚Ä¢ –°—Ç—Ä–∞—Ç–µ–≥—ñ—è: –£—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –Ω–∞ —Å–∞–π—Ç—ñ –¥–æ–≤—à–µ")
elif p_value_b1 < 0.05 and b1 < 0:
    print(f"   ‚Ä¢ –í–∏—è–≤–ª–µ–Ω–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∏–π –∑–≤'—è–∑–æ–∫ (–ø–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É)")
else:
    print(f"   ‚Ä¢ –ß–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ –Ω–µ —î –¥–æ—Å—Ç–∞—Ç–Ω—ñ–º –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–º –ø–æ–∫—É–ø–æ–∫")
    print(f"   ‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –≤–∫–ª—é—á–∏—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ –≤ –º–æ–¥–µ–ª—å")

print(f"\nüí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏:")
if r_squared > 0.5:
    print(f"   ‚Ä¢ –ú–æ–¥–µ–ª—å –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—å –¥–ª—è –±–∞–∑–æ–≤–∏—Ö –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤")
    print(f"   ‚Ä¢ –Ü–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ —á–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ —è–∫ —Ñ–∞–∫—Ç–æ—Ä —Ä–∞–Ω–∂—É–≤–∞–Ω–Ω—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π")
else:
    print(f"   ‚Ä¢ –ú–æ–¥–µ–ª—å –ø–æ—Ç—Ä–µ–±—É—î –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è")
    print(f"   ‚Ä¢ –î–æ–¥–∞—Ç–∏ —ñ–Ω—à—ñ —Ñ–∞–∫—Ç–æ—Ä–∏: –∫–ª—ñ–∫–∏, –ø–µ—Ä–µ–≥–ª—è–¥–∏ —Å—Ç–æ—Ä—ñ–Ω–æ–∫, —ñ—Å—Ç–æ—Ä—ñ—é –ø–æ–∫—É–ø–æ–∫")

print("\n" + "="*70)
print("–î–ï–¢–ê–õ–¨–ù–ò–ô –°–¢–ê–¢–ò–°–¢–ò–ß–ù–ò–ô –ó–í–Ü–¢")
print("="*70)
print(model.summary())
print("="*70)