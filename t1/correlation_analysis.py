import pandas as pd
from scipy.stats import pearsonr

# ============================================================
# –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –î–ê–ù–ò–• –ó CSV
# ============================================================

print("="*70)
print("–ö–û–†–ï–õ–Ø–¶–Ü–ô–ù–ò–ô –ê–ù–ê–õ–Ü–ó –ü–û–í–ï–î–Ü–ù–ö–ò –ö–û–†–ò–°–¢–£–í–ê–ß–Ü–í")
print("="*70)

# –ß–∏—Ç–∞–Ω–Ω—è CSV —Ñ–∞–π–ª—É
csv_filename = 'user_behavior_data.csv'
df = pd.read_csv(csv_filename)

print(f"\n‚úÖ –î–∞–Ω—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ —Ñ–∞–π–ª—É: {csv_filename}")
print(f"üìä –†–æ–∑–º—ñ—Ä –¥–∞—Ç–∞—Å–µ—Ç—É: {df.shape[0]} —Ä—è–¥–∫—ñ–≤ √ó {df.shape[1]} —Å—Ç–æ–≤–ø—Ü—ñ–≤")

print("\n--- –ü–µ—Ä—à—ñ 5 –∑–∞–ø–∏—Å—ñ–≤ ---")
print(df.head())

# ============================================================
# –ö–û–†–ï–õ–Ø–¶–Ü–ô–ù–ò–ô –ê–ù–ê–õ–Ü–ó
# ============================================================

print("\n" + "="*70)
print("–í–ò–ö–û–ù–ê–ù–ù–Ø –ó–ê–í–î–ê–ù–ù–Ø")
print("="*70)

# –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∑–º—ñ–Ω–Ω–∏—Ö –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É
X = df['–ß–∞—Å_–Ω–∞_—Å–∞–π—Ç—ñ_—Ö–≤']
Y = df['–ö—ñ–ª—å–∫—ñ—Å—Ç—å_–ø–æ–∫—É–ø–æ–∫']

print("\n--- –ó–º—ñ–Ω–Ω—ñ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É ---")
print(f"–ù–µ–∑–∞–ª–µ–∂–Ω–∞ –∑–º—ñ–Ω–Ω–∞ (X): –ß–∞—Å –Ω–∞ —Å–∞–π—Ç—ñ (—Ö–≤)")
print(f"–ó–∞–ª–µ–∂–Ω–∞ –∑–º—ñ–Ω–Ω–∞ (Y): –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–∫—É–ø–æ–∫")

# --- –ó–ê–í–î–ê–ù–ù–Ø 1: –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó –ü—ñ—Ä—Å–æ–Ω–∞ ---
r, p_value = pearsonr(X, Y)

print("\n" + "-"*70)
print("–ó–ê–í–î–ê–ù–ù–Ø 1: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –º–µ—Ç–æ–¥—É —Ç–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∫–æ—Ä–µ–ª—è—Ü—ñ—ó")
print("-"*70)

print(f"\n–û–±—Ä–∞–Ω–∏–π –º–µ—Ç–æ–¥: –ö–æ—Ä–µ–ª—è—Ü—ñ—è –ü—ñ—Ä—Å–æ–Ω–∞")
print(f"–ü—Ä–∏—á–∏–Ω–∞: –î–ª—è –æ—Ü—ñ–Ω–∫–∏ –ª—ñ–Ω—ñ–π–Ω–æ–≥–æ –∑–≤'—è–∑–∫—É –º—ñ–∂ –¥–≤–æ–º–∞ –∫—ñ–ª—å–∫—ñ—Å–Ω–∏–º–∏ –∑–º—ñ–Ω–Ω–∏–º–∏")

print(f"\n–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É:")
print(f"–ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü—ñ—ó (r): {r:.4f}")
print(f"P-value (—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∞ –∑–Ω–∞—á—É—â—ñ—Å—Ç—å): {p_value:.4f}")

# --- –ó–ê–í–î–ê–ù–ù–Ø 2: –í–∏—Å–Ω–æ–≤–æ–∫ –ø—Ä–æ —Ç–∏–ø –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É ---
print("\n" + "-"*70)
print("–ó–ê–í–î–ê–ù–ù–Ø 2: –í–∏—Å–Ω–æ–≤–æ–∫ –ø—Ä–æ —Ç–∏–ø –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É")
print("-"*70)

# –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞–ø—Ä—è–º–∫—É –∑–≤'—è–∑–∫—É
direction = "–ø—Ä—è–º–∏–π (–ø–æ–∑–∏—Ç–∏–≤–Ω–∏–π)" if r > 0 else "–æ–±–µ—Ä–Ω–µ–Ω–∏–π (–Ω–µ–≥–∞—Ç–∏–≤–Ω–∏–π)"
abs_r = abs(r)

# –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å–∏–ª–∏ –∑–≤'—è–∑–∫—É –∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ—é —à–∫–∞–ª–æ—é
if 0.9 < abs_r <= 1.0:
    strength = "–¥—É–∂–µ –≤–∏—Å–æ–∫–∏–π"
elif 0.7 < abs_r <= 0.9:
    strength = "–≤–∏—Å–æ–∫–∏–π"
elif 0.5 < abs_r <= 0.7:
    strength = "–ø–æ–º—ñ—Ç–Ω–∏–π"
elif 0.3 < abs_r <= 0.5:
    strength = "–ø–æ–º—ñ—Ä–Ω–∏–π"
else:
    strength = "—Å–ª–∞–±–∫–∏–π"

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ—ó –∑–Ω–∞—á—É—â–æ—Å—Ç—ñ
significance = "—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â–∏–π" if p_value < 0.05 else "—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –Ω–µ –∑–Ω–∞—á—É—â–∏–π"

print(f"\n1. –ù–∞–ø—Ä—è–º–æ–∫ –∑–≤'—è–∑–∫—É: {direction}")
print(f"   –ü–æ—è—Å–Ω–µ–Ω–Ω—è: –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç r = {r:.4f} {'>' if r > 0 else '<'} 0")

print(f"\n2. –¢—ñ—Å–Ω–æ—Ç–∞ (—Å–∏–ª–∞) –∑–≤'—è–∑–∫—É: {strength}")
print(f"   –ö—Ä–∏—Ç–µ—Ä—ñ–π: |r| = {abs_r:.4f}")

print(f"\n3. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∞ –∑–Ω–∞—á—É—â—ñ—Å—Ç—å: {significance}")
print(f"   –ö—Ä–∏—Ç–µ—Ä—ñ–π: p-value = {p_value:.4f} {'<' if p_value < 0.05 else '‚â•'} 0.05")

print(f"\n4. –û–±—Å—è–≥ –≤–∏–±—ñ—Ä–∫–∏: n = {len(df)} –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤")

# ============================================================
# –§–Ü–ù–ê–õ–¨–ù–ò–ô –í–ò–°–ù–û–í–û–ö
# ============================================================

print("\n" + "="*70)
print("–§–Ü–ù–ê–õ–¨–ù–ò–ô –í–ò–°–ù–û–í–û–ö")
print("="*70)

print(f"\n–í–∏—è–≤–ª–µ–Ω–æ {strength} {direction} –∑–≤'—è–∑–æ–∫ –º—ñ–∂ —á–∞—Å–æ–º –Ω–∞ —Å–∞–π—Ç—ñ")
print(f"—Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –ø–æ–∫—É–ø–æ–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ (r = {r:.4f}).")

if p_value < 0.05:
    print(f"\n–ó–≤'—è–∑–æ–∫ —î —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –∑–Ω–∞—á—É—â–∏–º (p = {p_value:.4f} < 0.05),")
    print(f"—â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î –Ω–∞—è–≤–Ω—ñ—Å—Ç—å —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É –º—ñ–∂ –∑–º—ñ–Ω–Ω–∏–º–∏.")
else:
    print(f"\n–£–í–ê–ì–ê: –ó–≤'—è–∑–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–æ –Ω–µ –∑–Ω–∞—á—É—â–∏–π (p = {p_value:.4f} ‚â• 0.05),")
    print(f"—â–æ –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –≤–∑–∞—î–º–æ–∑–≤'—è–∑–∫—É.")

print("\n–ü—Ä–∞–∫—Ç–∏—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏:")
if abs_r > 0.5:
    print(f"–ß–∞—Å –ø–µ—Ä–µ–±—É–≤–∞–Ω–Ω—è –Ω–∞ —Å–∞–π—Ç—ñ –º–æ–∂–µ –±—É—Ç–∏ –≤–∞–∂–ª–∏–≤–∏–º —Ñ–∞–∫—Ç–æ—Ä–æ–º –¥–ª—è")
    print(f"–ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –π–º–æ–≤—ñ—Ä–Ω–æ—Å—Ç—ñ –ø–æ–∫—É–ø–∫–∏ —Ç–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π.")
else:
    print(f"–°–ª—ñ–¥ —Ä–æ–∑–≥–ª—è–Ω—É—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ–∞–∫—Ç–æ—Ä–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤")
    print(f"–¥–ª—è –ø–æ–±—É–¥–æ–≤–∏ –±—ñ–ª—å—à —Ç–æ—á–Ω–æ—ó –º–æ–¥–µ–ª—ñ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ–π.")

print("\n" + "="*70)